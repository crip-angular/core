!function(i,n){"use strict";n.core=i.module("crip.core",[])}(angular,window.crip||(window.crip={})),function(i,n,t,e,r,o,c){"use strict";function u(){function n(i){return this.filter(function(n){return i.indexOf(n)<0})}function u(i,n){if("undefined"==typeof n)return void this.splice(this.indexOf(i)||this.length,1);for(var t=this.length-1;t>=0;t--)this[t][n]==i&&this.splice(t,1)}function f(n){return i.isUndefined(n)||""===n||null===n||n!==n}function s(i){return!f(i)}function a(n,t){var e=arguments;if(0===e.length||f(e[0]))return!1;var r=e[0];for(var o in e)if("0"!==o){if(!r.hasOwnProperty(e[o]))return!1;if(r=r[e[o]],i.isUndefined(r))return!1}return!0}function p(i){return this.replace(/{([^{}]*)}/g,function(n,t){var e=i[t];return"string"==typeof e||"number"==typeof e?e:n})}function d(i){return i=i||(i={}),i.value=this,i.size=o.log(i.value)/o.log(1e3)|0,i.num=(i.value/o.pow(1e3,i.size)).toFixed(2),i.text=i.size?"kMGTPEZY"[--i.size]+"B":"Bytes","{num} {text}".supplant(i)}function l(i,n){var t=this;return t.replace(new c(i,"g"),n)}t.prototype.diff=n,t.prototype.removeItem=u,e.prototype.supplant=p,e.prototype.replaceAll=l,r.prototype.toBytes=d,i.extend(i,{isEmpty:f,hasValue:s,hasProperty:a})}n.core.config(u),u.$inject=[]}(angular,window.crip||(window.crip={}),Array,String,Number,Math,RegExp),function(i,n){"use strict";function t(n){function t(t){return i.isObject(t)&&t instanceof n.File}function e(i){var n="|"+i.type.slice(i.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(n)}i.extend(i,{isFile:t,isImage:e,fileSupport:!(!n.FileReader||!n.CanvasRenderingContext2D)})}n.core.run(t),t.$inject=["$window"]}(angular,window.crip||(window.crip={})),function(i,n){"use strict";function t(){function i(i,n,t,e){n.bind("keydown keypress",function(n){13===n.which&&(i.$apply(function(){i.$eval(t.cripEnter,{event:n})}),n.preventDefault())}),i.$on("$destroy",function(){n.off(t.cripEnter)})}return{restrict:"A",link:i}}n.core.directive("cripEnter",t),t.$inject=[]}(angular,window.crip||(window.crip={})),function(i){"use strict";function n(i){function n(n,t,e,r){t.on(e.cripFocus,function(){i(e.cripSelector)}),n.$on("$destroy",function(){t.off(e.cripFocus)})}return{restrict:"A",link:n}}i.core.directive("cripFocus",n),n.$inject=["focus"]}(window.crip||(window.crip={})),function(i,n){"use strict";function t(){function n(n,t,e){function r(i){var n=new Image;n.onload=o,n.src=i.target.result}function o(){var i=c.width||this.width/this.height*c.height,n=c.height||this.height/this.width*c.width;u.attr({width:i,height:n}),u[0].getContext("2d").drawImage(this,0,0,i,n)}if(i.fileSupport){var c=n.$eval(e.cripThumb);if(!i.isFile(c.file)||!i.isImage(c.file))return void t.hide();var u=t.find("canvas"),f=new FileReader;f.onload=r,f.readAsDataURL(c.file)}}return{restrict:"A",template:"<canvas/>",link:n}}n.core.directive("cripThumb",t)}(angular,window.crip||(window.crip={})),function(i,n){"use strict";function t(n){return function(t,e){n(function(){var n=i(t);1===n.length&&("function"==typeof e?n.focus(e):n.focus())})}}n.core.factory("focus",t),t.$inject=["$timeout"]}(jQuery,window.crip||(window.crip={})),function(i,n){"use strict";function t(){var i="-_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-";this.changeChars=function(n){i=n},this["new"]=function(t){t|=16;for(var e="",r=0;t>r;r++)e+=i.charAt(n.floor(n.random()*i.length));return e}}i.core.service("cripStrRandom",t),t.$inject=[]}(window.crip||(window.crip={}),Math);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvY29yZS5tb2R1bGUuanMiLCIvc291cmNlL2NvbmZpZy5qcyIsIi9zb3VyY2UvZmlsZS5leHRlbnNpb25zLmpzIiwiL3NvdXJjZS9kaXJlY3RpdmVzL2NyaXBFbnRlci5qcyIsIi9zb3VyY2UvZGlyZWN0aXZlcy9jcmlwRm9jdXMuanMiLCIvc291cmNlL2RpcmVjdGl2ZXMvY3JpcFRodW1iLmpzIiwiL3NvdXJjZS9mYWN0b3JpZXMvZm9jdXMuanMiLCIvc291cmNlL3NlcnZpY2VzL2NyaXBTdHJSYW5kb20uanMiXSwibmFtZXMiOlsibmciLCJjcmlwIiwiY29yZSIsIm1vZHVsZSIsImFuZ3VsYXIiLCJ3aW5kb3ciLCJBcnJheSIsIlN0cmluZyIsIk51bWJlciIsIk1hdGgiLCJSZWdFeHAiLCJDb3JlQ29uZmlnIiwiZGlmZiIsImEiLCJ0aGlzIiwiZmlsdGVyIiwiaSIsImluZGV4T2YiLCJyZW1vdmVJdGVtIiwidmFsIiwia2V5Iiwic3BsaWNlIiwibGVuZ3RoIiwiaXNFbXB0eSIsInZhbHVlIiwiaXNVbmRlZmluZWQiLCJoYXNWYWx1ZSIsImhhc1Byb3BlcnR5Iiwib2JqZWN0IiwicHJvcGVydGllcyIsImFyZ3VtZW50cyIsInRhcmdldCIsImFyZyIsImhhc093blByb3BlcnR5Iiwic3VwcGxhbnQiLCJvIiwicmVwbGFjZSIsImIiLCJyIiwidG9CeXRlcyIsImhvbGRlciIsInNpemUiLCJsb2ciLCJudW0iLCJwb3ciLCJ0b0ZpeGVkIiwidGV4dCIsInN0cmluZ1JlcGxhY2VBbGwiLCJzZWFyY2hWYWx1ZSIsInJlcGxhY2VWYWx1ZSIsInByb3RvdHlwZSIsInJlcGxhY2VBbGwiLCJleHRlbmQiLCJjb25maWciLCIkaW5qZWN0IiwiRmlsZUV4dGVuc2lvbnMiLCIkd2luZG93IiwiaXNGaWxlIiwiaXRlbSIsImlzT2JqZWN0IiwiRmlsZSIsImlzSW1hZ2UiLCJmaWxlIiwidHlwZSIsInNsaWNlIiwibGFzdEluZGV4T2YiLCJmaWxlU3VwcG9ydCIsIkZpbGVSZWFkZXIiLCJDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQiLCJydW4iLCJjcmlwRW50ZXIiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0cnMiLCJjdHJsIiwiYmluZCIsImV2ZW50Iiwid2hpY2giLCIkYXBwbHkiLCIkZXZhbCIsInByZXZlbnREZWZhdWx0IiwiJG9uIiwib2ZmIiwicmVzdHJpY3QiLCJkaXJlY3RpdmUiLCJjcmlwRm9jdXMiLCJmb2N1cyIsIm9uIiwiY3JpcFNlbGVjdG9yIiwiY3JpcFRodW1iIiwib25Mb2FkRmlsZSIsImltZyIsIkltYWdlIiwib25sb2FkIiwib25Mb2FkSW1hZ2UiLCJzcmMiLCJyZXN1bHQiLCJ3aWR0aCIsInBhcmFtcyIsImhlaWdodCIsImNhbnZhcyIsImF0dHIiLCJnZXRDb250ZXh0IiwiZHJhd0ltYWdlIiwiaGlkZSIsImZpbmQiLCJyZWFkZXIiLCJyZWFkQXNEYXRhVVJMIiwidGVtcGxhdGUiLCIkIiwiJHRpbWVvdXQiLCJzZWxlY3RvciIsImNhbGxiYWNrIiwiJGVsZW1lbnQiLCJmYWN0b3J5IiwialF1ZXJ5IiwiY3JpcFN0clJhbmRvbSIsInBvc3NpYmxlIiwiY2hhbmdlQ2hhcnMiLCJjaGFycyIsImNoYXJBdCIsImZsb29yIiwicmFuZG9tIiwic2VydmljZSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxZQUVBQSxHQUFBQyxLQUFBRixFQUFBRyxPQUFBLGlCQUVBQyxRQUFBQyxPQUFBSixPQUFBSSxPQUFBSixVQ0xBLFNBQUFELEVBQUFDLEVBQUFLLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsWUFPQSxTQUFBQyxLQW9CQSxRQUFBQyxHQUFBQyxHQUNBLE1BQUFDLE1BQUFDLE9BQUEsU0FBQUMsR0FDQSxNQUFBSCxHQUFBSSxRQUFBRCxHQUFBLElBVUEsUUFBQUUsR0FBQUMsRUFBQUMsR0FDQSxHQUFBLG1CQUFBQSxHQUVBLFdBREFOLE1BQUFPLE9BQUFQLEtBQUFHLFFBQUFFLElBQUFMLEtBQUFRLE9BQUEs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RCxFQUFBNkQsUUFBQXNDLEVBQUFyQyxNQUVBLFdBREFXLEdBQUFnQyxNQUlBLElBQUFKLEdBQUE1QixFQUFBaUMsS0FBQSxVQUNBQyxFQUFBLEdBQUF4QyxXQUVBd0MsR0FBQWIsT0FBQUgsRUFDQWdCLEVBQUFDLGNBQUFULEVBQUFyQyxPQXBCQSxPQUNBc0IsU0FBQSxJQUNBeUIsU0FBQSxZQUNBdEMsS0FBQUEsR0FQQXRFLEVBQUFDLEtBQ0FtRixVQUFBLFlBQUFLLElBd0NBdEYsUUFBQUMsT0FBQUosT0FBQUksT0FBQUosVUM1Q0EsU0FBQTZHLEVBQUE3RyxHQUNBLFlBT0EsU0FBQXNGLEdBQUF3QixHQUNBLE1BQUEsVUFBQUMsRUFBQUMsR0FLQUYsRUFBQSxXQUNBLEdBQUFHLEdBQUFKLEVBQUFFLEVBQ0EsS0FBQUUsRUFBQTVGLFNBQ0Esa0JBQUEyRixHQUNBQyxFQUFBM0IsTUFBQTBCLEdBRUFDLEVBQUEzQixZQWpCQXRGLEVBQUFDLEtBQ0FpSCxRQUFBLFFBQUE1QixHQUVBQSxFQUFBakMsU0FBQSxhQW1CQThELE9BQUEvRyxPQUFBSixPQUFBSSxPQUFBSixVQ3pCQSxTQUFBQSxFQUFBUSxHQUNBLFlBT0EsU0FBQTRHLEtBQ0EsR0FBQUMsR0FBQSxvRUFFQXhHLE1BQUF5RyxZQUFBLFNBQUFDLEdBQ0FGLEVBQUFFLEdBR0ExRyxLQUFBQSxPQUFBLFNBQUFRLEdBQ0FBLEdBQUEsRUFFQSxLQUFBLEdBREEyRSxHQUFBLEdBQ0FqRixFQUFBLEVBQUFNLEVBQUFOLEVBQUFBLElBQ0FpRixHQUFBcUIsRUFBQUcsT0FBQWhILEVBQUFpSCxNQUFBakgsRUFBQWtILFNBQUFMLEVBQUFoRyxRQUdBLE9BQUEyRSxJQW5CQWhHLEVBQUFDLEtBQ0EwSCxRQUFBLGdCQUFBUCxHQUVBQSxFQUFBL0QsWUFtQkFqRCxPQUFBSixPQUFBSSxPQUFBSixTQUFBUSIsImZpbGUiOiJjcmlwLWNvcmUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIChuZywgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuY29yZSA9IG5nLm1vZHVsZSgnY3JpcC5jb3JlJywgW10pO1xyXG5cclxufSkoYW5ndWxhciwgd2luZG93LmNyaXAgfHwgKHdpbmRvdy5jcmlwID0ge30pKTsiLCIoZnVuY3Rpb24gKG5nLCBjcmlwLCBBcnJheSwgU3RyaW5nLCBOdW1iZXIsIE1hdGgsIFJlZ0V4cCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuY29yZVxyXG4gICAgICAgIC5jb25maWcoQ29yZUNvbmZpZyk7XHJcblxyXG4gICAgQ29yZUNvbmZpZy4kaW5qZWN0ID0gW107XHJcblxyXG4gICAgZnVuY3Rpb24gQ29yZUNvbmZpZygpIHtcclxuICAgICAgICBBcnJheS5wcm90b3R5cGUuZGlmZiA9IGRpZmY7XHJcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLnJlbW92ZUl0ZW0gPSByZW1vdmVJdGVtO1xyXG5cclxuICAgICAgICBTdHJpbmcucHJvdG90eXBlLnN1cHBsYW50ID0gc3VwcGxhbnQ7XHJcbiAgICAgICAgU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlQWxsID0gc3RyaW5nUmVwbGFjZUFsbDtcclxuICAgICAgICBOdW1iZXIucHJvdG90eXBlLnRvQnl0ZXMgPSB0b0J5dGVzO1xyXG5cclxuICAgICAgICBuZy5leHRlbmQobmcsIHtcclxuICAgICAgICAgICAgaXNFbXB0eTogaXNFbXB0eSxcclxuICAgICAgICAgICAgaGFzVmFsdWU6IGhhc1ZhbHVlLFxyXG4gICAgICAgICAgICBoYXNQcm9wZXJ0eTogaGFzUHJvcGVydHlcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2V0IGRpZmZlcmVudCBlbGVtZW50cyBmcm9tIEFycmF5XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBhXHJcbiAgICAgICAgICogQHJldHVybnMge0FycmF5fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGRpZmYoYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhLmluZGV4T2YoaSkgPCAwO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlbW92ZSBpdGVtIGZyb20gQXJyYXlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7Kn0gdmFsXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGtleVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZUl0ZW0odmFsLCBrZXkpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBrZXkgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaWNlKCh0aGlzLmluZGV4T2YodmFsKSB8fCB0aGlzLmxlbmd0aCksIDEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXNbaV1ba2V5XSA9PSB2YWwpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIERldGVybWluZXMgaXMgdmFsdWUgZW1wdHlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB2YWx1ZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGlzRW1wdHkodmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5nLmlzVW5kZWZpbmVkKHZhbHVlKSB8fCB2YWx1ZSA9PT0gJycgfHwgdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGV0ZXJtaW5lcyBpcyB2YWx1ZSBpbiBvYmplY3RcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB2YWx1ZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGhhc1ZhbHVlKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhaXNFbXB0eSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZXRlcm1pbmVzIGlzIG9iamVjdCBjb250YWluaW5nIHByb3BlcnRpZXMgY2hhaW5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmplY3RcclxuICAgICAgICAgKiBAcGFyYW0gey4uLnN0cmluZ30gcHJvcGVydGllc1xyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGhhc1Byb3BlcnR5KG9iamVjdCwgcHJvcGVydGllcykge1xyXG4gICAgICAgICAgICB2YXIgYSA9IGFyZ3VtZW50cztcclxuXHJcbiAgICAgICAgICAgIGlmIChhLmxlbmd0aCA9PT0gMCB8fCBpc0VtcHR5KGFbMF0pKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGFbMF07XHJcbiAgICAgICAgICAgIGZvciAodmFyIGFyZyBpbiBhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXJnID09PSAnMCcpXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCF0YXJnZXQuaGFzT3duUHJvcGVydHkoYVthcmddKSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0W2FbYXJnXV07XHJcbiAgICAgICAgICAgICAgICBpZiAobmcuaXNVbmRlZmluZWQodGFyZ2V0KSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBzaW1wbGUgdGVtcGxhdGluZyBtZXRob2QgZm9yIHJlcGxhY2luZyBwbGFjZWhvbGRlcnMgZW5jbG9zZWQgaW4gY3VybHkgYnJhY2VzLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IG9cclxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIHN1cHBsYW50KG8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgveyhbXnt9XSopfS9nLFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IG9bYl07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiByID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgciA9PT0gJ251bWJlcicgPyByIDogYTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbnZlcnQgTnVtYmVyIHRvIHVzZXIgZnJpZW5kbHkgYnl0ZSBzdHJpbmdcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBbaG9sZGVyXVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gdG9CeXRlcyhob2xkZXIpIHtcclxuICAgICAgICAgICAgaG9sZGVyID0gaG9sZGVyIHx8IChob2xkZXIgPSB7fSk7XHJcbiAgICAgICAgICAgIGhvbGRlci52YWx1ZSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGhvbGRlci5zaXplID0gTWF0aC5sb2coaG9sZGVyLnZhbHVlKSAvIE1hdGgubG9nKDFlMykgfCAwO1xyXG4gICAgICAgICAgICBob2xkZXIubnVtID0gKGhvbGRlci52YWx1ZSAvIE1hdGgucG93KDFlMywgaG9sZGVyLnNpemUpKS50b0ZpeGVkKDIpO1xyXG4gICAgICAgICAgICBob2xkZXIudGV4dCA9IChob2xkZXIuc2l6ZSA/ICgna01HVFBFWlknWy0taG9sZGVyLnNpemVdICsgJ0InKSA6ICdCeXRlcycpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuICd7bnVtfSB7dGV4dH0nLnN1cHBsYW50KGhvbGRlcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXBsYWNlIGFsbCBvY2N1cnJlbmNlcyBpbiBzdHJpbmdcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZWFyY2hWYWx1ZSBVc2VkIGluIFJlZ0V4cFxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfGZ1bmN0aW9ufSByZXBsYWNlVmFsdWVcclxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIHN0cmluZ1JlcGxhY2VBbGwoc2VhcmNoVmFsdWUsIHJlcGxhY2VWYWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5yZXBsYWNlKG5ldyBSZWdFeHAoc2VhcmNoVmFsdWUsICdnJyksIHJlcGxhY2VWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KShhbmd1bGFyLCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSksIEFycmF5LCBTdHJpbmcsIE51bWJlciwgTWF0aCwgUmVnRXhwKTsiLCIoZnVuY3Rpb24obmcsIGNyaXApe1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuY29yZVxyXG4gICAgICAgIC5ydW4oRmlsZUV4dGVuc2lvbnMpO1xyXG5cclxuICAgIEZpbGVFeHRlbnNpb25zLiRpbmplY3QgPSBbJyR3aW5kb3cnXTtcclxuXHJcbiAgICBmdW5jdGlvbiBGaWxlRXh0ZW5zaW9ucygkd2luZG93KSB7XHJcblxyXG4gICAgICAgIG5nLmV4dGVuZChuZywge1xyXG4gICAgICAgICAgICBpc0ZpbGU6IGlzRmlsZSxcclxuICAgICAgICAgICAgaXNJbWFnZTogaXNJbWFnZSxcclxuICAgICAgICAgICAgZmlsZVN1cHBvcnQ6ICEhKCR3aW5kb3cuRmlsZVJlYWRlciAmJiAkd2luZG93LkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRClcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGV0ZXJtaW5lcyBpcyBpdGVtIGFuIGluc3RhbmNlIG9mIEZpbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7Kn0gaXRlbVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGlzRmlsZShpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZy5pc09iamVjdChpdGVtKSAmJiBpdGVtIGluc3RhbmNlb2YgJHdpbmRvdy5GaWxlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGV0ZXJtaW5lcyBpcyBmaWxlIGFuIHR5cGUgb2YgaW1hZ2VcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7RmlsZX0gZmlsZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGlzSW1hZ2UoZmlsZSkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9ICd8JyArIGZpbGUudHlwZS5zbGljZShmaWxlLnR5cGUubGFzdEluZGV4T2YoJy8nKSArIDEpICsgJ3wnO1xyXG4gICAgICAgICAgICByZXR1cm4gJ3xqcGd8cG5nfGpwZWd8Ym1wfGdpZnwnLmluZGV4T2YodHlwZSkgIT09IC0xO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoYW5ndWxhciwgd2luZG93LmNyaXAgfHwgKHdpbmRvdy5jcmlwID0ge30pKTsiLCIoZnVuY3Rpb24gKG5nLCBjcmlwKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5jb3JlXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnY3JpcEVudGVyJywgY3JpcEVudGVyKTtcclxuXHJcbiAgICBjcmlwRW50ZXIuJGluamVjdCA9IFtdO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNyaXBFbnRlcigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICBsaW5rOiBsaW5rXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmwpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5iaW5kKFwia2V5ZG93biBrZXlwcmVzc1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMTMpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZXZhbChhdHRycy5jcmlwRW50ZXIsIHsnZXZlbnQnOiBldmVudH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZXMgYm91bmQgZXZlbnRzIGluIHRoZSBlbGVtZW50IGl0c2VsZlxyXG4gICAgICAgICAgICAvLyB3aGVuIHRoZSBzY29wZSBpcyBkZXN0cm95ZWRcclxuICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQub2ZmKGF0dHJzLmNyaXBFbnRlcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoYW5ndWxhciwgd2luZG93LmNyaXAgfHwgKHdpbmRvdy5jcmlwID0ge30pKTtcclxuIiwiKGZ1bmN0aW9uIChjcmlwKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5jb3JlXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnY3JpcEZvY3VzJywgY3JpcEZvY3VzKTtcclxuXHJcbiAgICBjcmlwRm9jdXMuJGluamVjdCA9IFsnZm9jdXMnXTtcclxuXHJcbiAgICBmdW5jdGlvbiBjcmlwRm9jdXMoZm9jdXMpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICBsaW5rOiBsaW5rXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmwpIHtcclxuICAgICAgICAgICAgZWxlbWVudC5vbihhdHRycy5jcmlwRm9jdXMsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGZvY3VzKGF0dHJzLmNyaXBTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gUmVtb3ZlcyBib3VuZCBldmVudHMgaW4gdGhlIGVsZW1lbnQgaXRzZWxmXHJcbiAgICAgICAgICAgIC8vIHdoZW4gdGhlIHNjb3BlIGlzIGRlc3Ryb3llZFxyXG4gICAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5vZmYoYXR0cnMuY3JpcEZvY3VzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSh3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyIsIihmdW5jdGlvbiAobmcsIGNyaXApIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBjcmlwLmNvcmVcclxuICAgICAgICAuZGlyZWN0aXZlKCdjcmlwVGh1bWInLCBjcmlwVGh1bWIpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNyaXBUaHVtYigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZTogJzxjYW52YXMvPicsXHJcbiAgICAgICAgICAgIGxpbms6IGxpbmtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycyl7XHJcbiAgICAgICAgICAgIGlmKCFuZy5maWxlU3VwcG9ydCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHNjb3BlLiRldmFsKGF0dHJzLmNyaXBUaHVtYik7XHJcblxyXG4gICAgICAgICAgICBpZiAoIW5nLmlzRmlsZShwYXJhbXMuZmlsZSkgfHwgIW5nLmlzSW1hZ2UocGFyYW1zLmZpbGUpKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGVsZW1lbnQuZmluZCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG5cclxuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IG9uTG9hZEZpbGU7XHJcbiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKHBhcmFtcy5maWxlKTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uTG9hZEZpbGUoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgIGltZy5vbmxvYWQgPSBvbkxvYWRJbWFnZTtcclxuICAgICAgICAgICAgICAgIGltZy5zcmMgPSBldmVudC50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkxvYWRJbWFnZSgpIHtcclxuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHBhcmFtcy53aWR0aCB8fCB0aGlzLndpZHRoIC8gdGhpcy5oZWlnaHQgKiBwYXJhbXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHBhcmFtcy5oZWlnaHQgfHwgdGhpcy5oZWlnaHQgLyB0aGlzLndpZHRoICogcGFyYW1zLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgY2FudmFzLmF0dHIoe3dpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHR9KTtcclxuICAgICAgICAgICAgICAgIGNhbnZhc1swXS5nZXRDb250ZXh0KCcyZCcpLmRyYXdJbWFnZSh0aGlzLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKGFuZ3VsYXIsIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiKGZ1bmN0aW9uICgkLCBjcmlwKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5jb3JlXHJcbiAgICAgICAgLmZhY3RvcnkoJ2ZvY3VzJywgZm9jdXMpO1xyXG5cclxuICAgIGZvY3VzLiRpbmplY3QgPSBbJyR0aW1lb3V0J107XHJcblxyXG4gICAgZnVuY3Rpb24gZm9jdXMoJHRpbWVvdXQpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNlbGVjdG9yLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAvLyB0aW1lb3V0IG1ha2VzIHN1cmUgdGhhdCBpdCBpcyBpbnZva2VkIGFmdGVyIGFueSBvdGhlciBldmVudCBoYXMgYmVlbiB0cmlnZ2VyZWQuXHJcbiAgICAgICAgICAgIC8vIGUuZy4gY2xpY2sgZXZlbnRzIHRoYXQgbmVlZCB0byBydW4gYmVmb3JlIHRoZSBmb2N1cyBvclxyXG4gICAgICAgICAgICAvLyBpbnB1dHMgZWxlbWVudHMgdGhhdCBhcmUgaW4gYSBkaXNhYmxlZCBzdGF0ZSBidXQgYXJlIGVuYWJsZWQgd2hlbiB0aG9zZSBldmVudHNcclxuICAgICAgICAgICAgLy8gYXJlIHRyaWdnZXJlZC5cclxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyICRlbGVtZW50ID0gJChzZWxlY3Rvcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoJGVsZW1lbnQubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQuZm9jdXMoY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KShqUXVlcnksIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiKGZ1bmN0aW9uIChjcmlwLCBNYXRoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5jb3JlXHJcbiAgICAgICAgLnNlcnZpY2UoJ2NyaXBTdHJSYW5kb20nLCBjcmlwU3RyUmFuZG9tKTtcclxuXHJcbiAgICBjcmlwU3RyUmFuZG9tLiRpbmplY3QgPSBbXTtcclxuXHJcbiAgICBmdW5jdGlvbiBjcmlwU3RyUmFuZG9tKCkge1xyXG4gICAgICAgIHZhciBwb3NzaWJsZSA9ICctX0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Xy0nO1xyXG5cclxuICAgICAgICB0aGlzLmNoYW5nZUNoYXJzID0gZnVuY3Rpb24gKGNoYXJzKSB7XHJcbiAgICAgICAgICAgIHBvc3NpYmxlID0gY2hhcnM7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5uZXcgPSBmdW5jdGlvbiAobGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxlbmd0aCB8PSAxNjtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9ICcnO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgKz0gcG9zc2libGUuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBvc3NpYmxlLmxlbmd0aCkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn0pKHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSwgTWF0aCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
