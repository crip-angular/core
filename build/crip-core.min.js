!function(t,n){"use strict";n.core=t.module("crip.core",[])}(angular,window.crip||(window.crip={})),function(t){"use strict";function n(t){return this.filter(function(n){return t.indexOf(n)<0})}function i(t,n){if("undefined"==typeof n)return void this.splice(this.indexOf(t)||this.length,1);for(var i=this.length-1;i>=0;i--)this[i][n]==t&&this.splice(i,1)}function e(t){var n=arguments;"undefined"==typeof t&&(n=[void 0,"",null,NaN]);for(var i=0;i<this.length;i++)for(var e=0;e<n.length;e++)this[i]===n[e]&&(this.splice(i,1),i--);return this}t.prototype.diff=n,t.prototype.removeItem=i,t.prototype.clean=e}(Array),function(t,n,i,e,r,o,c){"use strict";function u(){function n(n){return t.isUndefined(n)||""===n||null===n||n!==n}function i(t){return!n(t)}function e(i,e){var r=arguments;if(0===r.length||n(r[0]))return!1;var o=r[0];for(var c in r)if("0"!==c){if(!o.hasOwnProperty(r[c]))return!1;if(o=o[r[c]],t.isUndefined(o))return!1}return!0}function r(t){t=t||[];for(var n=[],i=0;i<t.length;++i)n.push(t.item(i));return n}t.extend(t,{isEmpty:n,hasValue:i,hasProperty:e,nodesToArray:r})}n.core.config(u),u.$inject=[]}(angular,window.crip||(window.crip={}),Array,String,Number,Math,RegExp),function(t,n){"use strict";function i(n){function i(i){return t.isObject(i)&&i instanceof n.File}function e(t){var n="|"+t.type.slice(t.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(n)}t.extend(t,{isFile:i,isImage:e,isHtml5:!(!File||!FormData),fileSupport:!(!n.FileReader||!n.CanvasRenderingContext2D)})}n.core.run(i),i.$inject=["$window"]}(angular,window.crip||(window.crip={})),function(t){"use strict";function n(t){return t=t||(t={}),t.value=this,t.size=Math.log(t.value)/Math.log(1e3)|0,t.num=(t.value/Math.pow(1e3,t.size)).toFixed(2),t.text=t.size?"kMGTPEZY"[--t.size]+"B":"Bytes","{num} {text}".supplant(t)}t.prototype.toBytes=n}(Number),function(t){"use strict";function n(t){return this.replace(/{([^{}]*)}/g,function(n,i){var e=t[i];return"string"==typeof e||"number"==typeof e?e:n})}function i(t,n){var i=this;return i.replace(new RegExp(t,"g"),n)}t.prototype.supplant=n,t.prototype.replaceAll=i}(String),function(t,n){"use strict";function i(t){function n(n,i,e,r){var o=t(e.cripContextmenu);i.bind("contextmenu",function(t){n.$apply(function(){t.preventDefault(),o(n,{$event:t,$element:i})})}),n.$on("$destroy",function(){i.off(e.cripContextmenu)})}return{restrict:"A",link:n}}n.core.directive("cripContextmenu",i),i.$inject=["$parse"]}(angular,window.crip||(window.crip={})),function(t,n){"use strict";function i(){function t(t,n,i,e){n.bind("keydown keypress",function(n){13===n.which&&(t.$apply(function(){t.$eval(i.cripEnter,{event:n})}),n.preventDefault())}),t.$on("$destroy",function(){n.off(i.cripEnter)})}return{restrict:"A",link:t}}n.core.directive("cripEnter",i),i.$inject=[]}(angular,window.crip||(window.crip={})),function(t){"use strict";function n(t){function n(n,i,e,r){i.on(e.cripFocus,function(){t(e.cripSelector)}),n.$on("$destroy",function(){i.off(e.cripFocus)})}return{restrict:"A",link:n}}t.core.directive("cripFocus",n),n.$inject=["focus"]}(window.crip||(window.crip={})),function(t,n){"use strict";function i(){function n(n,i,e){function r(t){var n=new Image;n.onload=o,n.src=t.target.result}function o(){var t=c.width||this.width/this.height*c.height,n=c.height||this.height/this.width*c.width;u.attr({width:t,height:n}),u[0].getContext("2d").drawImage(this,0,0,t,n)}if(t.fileSupport){var c=n.$eval(e.cripThumb);if(!t.isFile(c.file)||!t.isImage(c.file))return void i.hide();var u=i.find("canvas"),f=new FileReader;f.onload=r,f.readAsDataURL(c.file)}}return{restrict:"A",template:"<canvas/>",link:n}}n.core.directive("cripThumb",i)}(angular,window.crip||(window.crip={})),function(t,n){"use strict";function i(n){return function(i,e){n(function(){var n=t(i);1===n.length&&("function"==typeof e?n.focus(e):n.focus())})}}n.core.factory("focus",i),i.$inject=["$timeout"]}(jQuery,window.crip||(window.crip={})),function(t,n){"use strict";function i(){var t="-_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-";this.changeChars=function(n){t=n},this["new"]=function(i){i|=16;for(var e="",r=0;i>r;r++)e+=t.charAt(n.floor(n.random()*t.length));return e}}t.core.service("cripStrRandom",i),i.$inject=[]}(window.crip||(window.crip={}),Math);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvY29yZS5tb2R1bGUuanMiLCIvc291cmNlL2FycmF5LmV4dGVuc2lvbnMuanMiLCIvc291cmNlL2NvbmZpZy5qcyIsIi9zb3VyY2UvZmlsZS5leHRlbnNpb25zLmpzIiwiL3NvdXJjZS9udW1iZXIuZXh0ZW5zaW9ucy5qcyIsIi9zb3VyY2Uvc3RyaW5nLmV4dGVuc2lvbnMuanMiLCIvc291cmNlL2RpcmVjdGl2ZXMvY3JpcENvbnRleHRtZW51LmpzIiwiL3NvdXJjZS9kaXJlY3RpdmVzL2NyaXBFbnRlci5qcyIsIi9zb3VyY2UvZGlyZWN0aXZlcy9jcmlwRm9jdXMuanMiLCIvc291cmNlL2RpcmVjdGl2ZXMvY3JpcFRodW1iLmpzIiwiL3NvdXJjZS9mYWN0b3JpZXMvZm9jdXMuanMiLCIvc291cmNlL3NlcnZpY2VzL2NyaXBTdHJSYW5kb20uanMiXSwibmFtZXMiOlsibmciLCJjcmlwIiwiY29yZSIsIm1vZHVsZSIsImFuZ3VsYXIiLCJ3aW5kb3ciLCJBcnJheSIsImRpZmYiLCJhIiwidGhpcyIsImZpbHRlciIsImkiLCJpbmRleE9mIiwicmVtb3ZlSXRlbSIsInZhbCIsImtleSIsInNwbGljZSIsImxlbmd0aCIsImNsZWFuIiwiZGVsZXRlX3ZhbHVlIiwiY2xlYW5fZnJvbSIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsIk5hTiIsImoiLCJwcm90b3R5cGUiLCJTdHJpbmciLCJOdW1iZXIiLCJNYXRoIiwiUmVnRXhwIiwiQ29yZUNvbmZpZyIsImlzRW1wdHkiLCJ2YWx1ZSIsImlzVW5kZWZpbmVkIiwiaGFzVmFsdWUiLCJoYXNQcm9wZXJ0eSIsIm9iamVjdCIsInByb3BlcnRpZXMiLCJ0YXJnZXQiLCJhcmciLCJoYXNPd25Qcm9wZXJ0eSIsIm5vZGVzVG9BcnJheSIsIm5vZGVzIiwicmVzdWx0cyIsInB1c2giLCJpdGVtIiwiZXh0ZW5kIiwiY29uZmlnIiwiJGluamVjdCIsIkZpbGVFeHRlbnNpb25zIiwiJHdpbmRvdyIsImlzRmlsZSIsImlzT2JqZWN0IiwiRmlsZSIsImlzSW1hZ2UiLCJmaWxlIiwidHlwZSIsInNsaWNlIiwibGFzdEluZGV4T2YiLCJpc0h0bWw1IiwiRm9ybURhdGEiLCJmaWxlU3VwcG9ydCIsIkZpbGVSZWFkZXIiLCJDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQiLCJydW4iLCJ0b0J5dGVzIiwiaG9sZGVyIiwic2l6ZSIsImxvZyIsIm51bSIsInBvdyIsInRvRml4ZWQiLCJ0ZXh0Iiwic3VwcGxhbnQiLCJvIiwicmVwbGFjZSIsImIiLCJyIiwicmVwbGFjZUFsbCIsInNlYXJjaFZhbHVlIiwicmVwbGFjZVZhbHVlIiwiY3JpcENvbnRleHRtZW51IiwiJHBhcnNlIiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwiY3RybCIsImZuIiwiYmluZCIsImV2ZW50IiwiJGFwcGx5IiwicHJldmVudERlZmF1bHQiLCIkZXZlbnQiLCIkZWxlbWVudCIsIiRvbiIsIm9mZiIsInJlc3RyaWN0IiwiZGlyZWN0aXZlIiwiY3JpcEVudGVyIiwid2hpY2giLCIkZXZhbCIsImNyaXBGb2N1cyIsImZvY3VzIiwib24iLCJjcmlwU2VsZWN0b3IiLCJjcmlwVGh1bWIiLCJvbkxvYWRGaWxlIiwiaW1nIiwiSW1hZ2UiLCJvbmxvYWQiLCJvbkxvYWRJbWFnZSIsInNyYyIsInJlc3VsdCIsIndpZHRoIiwicGFyYW1zIiwiaGVpZ2h0IiwiY2FudmFzIiwiYXR0ciIsImdldENvbnRleHQiLCJkcmF3SW1hZ2UiLCJoaWRlIiwiZmluZCIsInJlYWRlciIsInJlYWRBc0RhdGFVUkwiLCJ0ZW1wbGF0ZSIsIiQiLCIkdGltZW91dCIsInNlbGVjdG9yIiwiY2FsbGJhY2siLCJmYWN0b3J5IiwialF1ZXJ5IiwiY3JpcFN0clJhbmRvbSIsInBvc3NpYmxlIiwiY2hhbmdlQ2hhcnMiLCJjaGFycyIsImNoYXJBdCIsImZsb29yIiwicmFuZG9tIiwic2VydmljZSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxZQUVBQSxHQUFBQyxLQUFB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QUFBLElBQ0FzRyxHQUFBb0IsRUFBQUcsT0FBQTVHLEVBQUE2RyxNQUFBN0csRUFBQThHLFNBQUFMLEVBQUFwSCxRQUdBLE9BQUFnRyxJQW5CQWhILEVBQUFDLEtBQ0F5SSxRQUFBLGdCQUFBUCxHQUVBQSxFQUFBcEYsWUFtQkEzQyxPQUFBSixPQUFBSSxPQUFBSixTQUFBMkIiLCJmaWxlIjoiY3JpcC1jb3JlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAobmcsIGNyaXApIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBjcmlwLmNvcmUgPSBuZy5tb2R1bGUoJ2NyaXAuY29yZScsIFtdKTtcclxuXHJcbn0pKGFuZ3VsYXIsIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiKGZ1bmN0aW9uIChBcnJheSkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIEFycmF5LnByb3RvdHlwZS5kaWZmID0gZGlmZjtcclxuICAgIEFycmF5LnByb3RvdHlwZS5yZW1vdmVJdGVtID0gcmVtb3ZlSXRlbTtcclxuICAgIEFycmF5LnByb3RvdHlwZS5jbGVhbiA9IGNsZWFuO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGRpZmZlcmVudCBlbGVtZW50cyBmcm9tIEFycmF5XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtBcnJheX0gYVxyXG4gICAgICogQHJldHVybnMge0FycmF5fVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBkaWZmKGEpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGEuaW5kZXhPZihpKSA8IDA7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgaXRlbSBmcm9tIEFycmF5XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsqfSB2YWxcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXlcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcmVtb3ZlSXRlbSh2YWwsIGtleSkge1xyXG4gICAgICAgIGlmICh0eXBlb2Yga2V5ID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3BsaWNlKCh0aGlzLmluZGV4T2YodmFsKSB8fCB0aGlzLmxlbmd0aCksIDEpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICBpZiAodGhpc1tpXVtrZXldID09IHZhbClcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENsZWFuIGFycmF5IGZyb20gZW1wdHkgdmFsdWVzXHJcbiAgICAgKiBJZiBwYXJhbWV0ZXJzIHByZXNlbnRlZCwgZGVsZXRlIGl0ZW1zIHdpdGNoIGNvbnRhaW5zIHBhc3NlZCB2YWx1ZVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7Li4uVH0gW2RlbGV0ZV92YWx1ZV1cclxuICAgICAqIEByZXR1cm5zIHtBcnJheX1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gY2xlYW4oZGVsZXRlX3ZhbHVlKSB7XHJcbiAgICAgICAgdmFyIGNsZWFuX2Zyb20gPSBhcmd1bWVudHM7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBkZWxldGVfdmFsdWUgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIGNsZWFuX2Zyb20gPSBbdW5kZWZpbmVkLCAnJywgbnVsbCwgTmFOXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNsZWFuX2Zyb20ubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzW2ldID09PSBjbGVhbl9mcm9tW2pdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaS0tO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbn0pKEFycmF5KTsiLCIoZnVuY3Rpb24gKG5nLCBjcmlwLCBBcnJheSwgU3RyaW5nLCBOdW1iZXIsIE1hdGgsIFJlZ0V4cCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuY29yZVxyXG4gICAgICAgIC5jb25maWcoQ29yZUNvbmZpZyk7XHJcblxyXG4gICAgQ29yZUNvbmZpZy4kaW5qZWN0ID0gW107XHJcblxyXG4gICAgZnVuY3Rpb24gQ29yZUNvbmZpZygpIHtcclxuXHJcbiAgICAgICAgbmcuZXh0ZW5kKG5nLCB7XHJcbiAgICAgICAgICAgIGlzRW1wdHk6IGlzRW1wdHksXHJcbiAgICAgICAgICAgIGhhc1ZhbHVlOiBoYXNWYWx1ZSxcclxuICAgICAgICAgICAgaGFzUHJvcGVydHk6IGhhc1Byb3BlcnR5LFxyXG4gICAgICAgICAgICBub2Rlc1RvQXJyYXk6IG5vZGVzVG9BcnJheVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZXRlcm1pbmVzIGlzIHZhbHVlIGVtcHR5XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gdmFsdWVcclxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpc0VtcHR5KHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZy5pc1VuZGVmaW5lZCh2YWx1ZSkgfHwgdmFsdWUgPT09ICcnIHx8IHZhbHVlID09PSBudWxsIHx8IHZhbHVlICE9PSB2YWx1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIERldGVybWluZXMgaXMgdmFsdWUgaW4gb2JqZWN0XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gdmFsdWVcclxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBoYXNWYWx1ZSh2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gIWlzRW1wdHkodmFsdWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGV0ZXJtaW5lcyBpcyBvYmplY3QgY29udGFpbmluZyBwcm9wZXJ0aWVzIGNoYWluXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gb2JqZWN0XHJcbiAgICAgICAgICogQHBhcmFtIHsuLi5zdHJpbmd9IHByb3BlcnRpZXNcclxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBoYXNQcm9wZXJ0eShvYmplY3QsIHByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgdmFyIGEgPSBhcmd1bWVudHM7XHJcblxyXG4gICAgICAgICAgICBpZiAoYS5sZW5ndGggPT09IDAgfHwgaXNFbXB0eShhWzBdKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBhWzBdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBhcmcgaW4gYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGFyZyA9PT0gJzAnKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0Lmhhc093blByb3BlcnR5KGFbYXJnXSkpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldFthW2FyZ11dO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5nLmlzVW5kZWZpbmVkKHRhcmdldCkpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFubm95aW5nIG1ldGhvZCB0byBjb3B5IG5vZGVzIHRvIGFuIGFycmF5LCB0aGFua3MgdG8gSUVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7Tm9kZX0gW25vZGVzXVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtBcnJheX1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBub2Rlc1RvQXJyYXkobm9kZXMpIHtcclxuICAgICAgICAgICAgbm9kZXMgPSBub2RlcyB8fCBbXTtcclxuXHJcbiAgICAgICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChub2Rlcy5pdGVtKGkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSwgQXJyYXksIFN0cmluZywgTnVtYmVyLCBNYXRoLCBSZWdFeHApOyIsIihmdW5jdGlvbihuZywgY3JpcCl7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5jb3JlXHJcbiAgICAgICAgLnJ1bihGaWxlRXh0ZW5zaW9ucyk7XHJcblxyXG4gICAgRmlsZUV4dGVuc2lvbnMuJGluamVjdCA9IFsnJHdpbmRvdyddO1xyXG5cclxuICAgIGZ1bmN0aW9uIEZpbGVFeHRlbnNpb25zKCR3aW5kb3cpIHtcclxuXHJcbiAgICAgICAgbmcuZXh0ZW5kKG5nLCB7XHJcbiAgICAgICAgICAgIGlzRmlsZTogaXNGaWxlLFxyXG4gICAgICAgICAgICBpc0ltYWdlOiBpc0ltYWdlLFxyXG4gICAgICAgICAgICBpc0h0bWw1OiAhIShGaWxlICYmIEZvcm1EYXRhKSxcclxuICAgICAgICAgICAgZmlsZVN1cHBvcnQ6ICEhKCR3aW5kb3cuRmlsZVJlYWRlciAmJiAkd2luZG93LkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRClcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGV0ZXJtaW5lcyBpcyBpdGVtIGFuIGluc3RhbmNlIG9mIEZpbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7Kn0gaXRlbVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGlzRmlsZShpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZy5pc09iamVjdChpdGVtKSAmJiBpdGVtIGluc3RhbmNlb2YgJHdpbmRvdy5GaWxlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGV0ZXJtaW5lcyBpcyBmaWxlIGFuIHR5cGUgb2YgaW1hZ2VcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7RmlsZX0gZmlsZVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGlzSW1hZ2UoZmlsZSkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9ICd8JyArIGZpbGUudHlwZS5zbGljZShmaWxlLnR5cGUubGFzdEluZGV4T2YoJy8nKSArIDEpICsgJ3wnO1xyXG4gICAgICAgICAgICByZXR1cm4gJ3xqcGd8cG5nfGpwZWd8Ym1wfGdpZnwnLmluZGV4T2YodHlwZSkgIT09IC0xO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoYW5ndWxhciwgd2luZG93LmNyaXAgfHwgKHdpbmRvdy5jcmlwID0ge30pKTsiLCIoZnVuY3Rpb24oTnVtYmVyKXtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBOdW1iZXIucHJvdG90eXBlLnRvQnl0ZXMgPSB0b0J5dGVzO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydCBOdW1iZXIgdG8gdXNlciBmcmllbmRseSBieXRlIHN0cmluZ1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbaG9sZGVyXVxyXG4gICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdG9CeXRlcyhob2xkZXIpIHtcclxuICAgICAgICBob2xkZXIgPSBob2xkZXIgfHwgKGhvbGRlciA9IHt9KTtcclxuICAgICAgICBob2xkZXIudmFsdWUgPSB0aGlzO1xyXG4gICAgICAgIGhvbGRlci5zaXplID0gTWF0aC5sb2coaG9sZGVyLnZhbHVlKSAvIE1hdGgubG9nKDFlMykgfCAwO1xyXG4gICAgICAgIGhvbGRlci5udW0gPSAoaG9sZGVyLnZhbHVlIC8gTWF0aC5wb3coMWUzLCBob2xkZXIuc2l6ZSkpLnRvRml4ZWQoMik7XHJcbiAgICAgICAgaG9sZGVyLnRleHQgPSAoaG9sZGVyLnNpemUgPyAoJ2tNR1RQRVpZJ1stLWhvbGRlci5zaXplXSArICdCJykgOiAnQnl0ZXMnKTtcclxuXHJcbiAgICAgICAgcmV0dXJuICd7bnVtfSB7dGV4dH0nLnN1cHBsYW50KGhvbGRlcik7XHJcbiAgICB9XHJcbn0pKE51bWJlcik7IiwiKGZ1bmN0aW9uIChTdHJpbmcpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBTdHJpbmcucHJvdG90eXBlLnN1cHBsYW50ID0gc3VwcGxhbnQ7XHJcbiAgICBTdHJpbmcucHJvdG90eXBlLnJlcGxhY2VBbGwgPSByZXBsYWNlQWxsO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQSBzaW1wbGUgdGVtcGxhdGluZyBtZXRob2QgZm9yIHJlcGxhY2luZyBwbGFjZWhvbGRlcnMgZW5jbG9zZWQgaW4gY3VybHkgYnJhY2VzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBzdXBwbGFudChvKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgveyhbXnt9XSopfS9nLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHIgPSBvW2JdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiByID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgciA9PT0gJ251bWJlcicgPyByIDogYTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXBsYWNlIGFsbCBvY2N1cnJlbmNlcyBpbiBzdHJpbmdcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2VhcmNoVmFsdWUgVXNlZCBpbiBSZWdFeHBcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfGZ1bmN0aW9ufSByZXBsYWNlVmFsdWVcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHJlcGxhY2VBbGwoc2VhcmNoVmFsdWUsIHJlcGxhY2VWYWx1ZSkge1xyXG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQucmVwbGFjZShuZXcgUmVnRXhwKHNlYXJjaFZhbHVlLCAnZycpLCByZXBsYWNlVmFsdWUpO1xyXG4gICAgfVxyXG5cclxufSkoU3RyaW5nKTsiLCIoZnVuY3Rpb24gKG5nLCBjcmlwKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5jb3JlXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnY3JpcENvbnRleHRtZW51JywgY3JpcENvbnRleHRtZW51KTtcclxuXHJcbiAgICBjcmlwQ29udGV4dG1lbnUuJGluamVjdCA9IFsnJHBhcnNlJ107XHJcblxyXG4gICAgZnVuY3Rpb24gY3JpcENvbnRleHRtZW51KCRwYXJzZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIGxpbms6IGxpbmtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybCkge1xyXG4gICAgICAgICAgICB2YXIgZm4gPSAkcGFyc2UoYXR0cnMuY3JpcENvbnRleHRtZW51KTtcclxuICAgICAgICAgICAgZWxlbWVudC5iaW5kKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBmbihzY29wZSwgeyRldmVudDpldmVudCwgJGVsZW1lbnQ6IGVsZW1lbnR9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZXMgYm91bmQgZXZlbnRzIGluIHRoZSBlbGVtZW50IGl0c2VsZlxyXG4gICAgICAgICAgICAvLyB3aGVuIHRoZSBzY29wZSBpcyBkZXN0cm95ZWRcclxuICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQub2ZmKGF0dHJzLmNyaXBDb250ZXh0bWVudSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoYW5ndWxhciwgd2luZG93LmNyaXAgfHwgKHdpbmRvdy5jcmlwID0ge30pKTtcclxuIiwiKGZ1bmN0aW9uIChuZywgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuY29yZVxyXG4gICAgICAgIC5kaXJlY3RpdmUoJ2NyaXBFbnRlcicsIGNyaXBFbnRlcik7XHJcblxyXG4gICAgY3JpcEVudGVyLiRpbmplY3QgPSBbXTtcclxuXHJcbiAgICBmdW5jdGlvbiBjcmlwRW50ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgbGluazogbGlua1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJsKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYmluZChcImtleWRvd24ga2V5cHJlc3NcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGV2YWwoYXR0cnMuY3JpcEVudGVyLCB7J2V2ZW50JzogZXZlbnR9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBSZW1vdmVzIGJvdW5kIGV2ZW50cyBpbiB0aGUgZWxlbWVudCBpdHNlbGZcclxuICAgICAgICAgICAgLy8gd2hlbiB0aGUgc2NvcGUgaXMgZGVzdHJveWVkXHJcbiAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50Lm9mZihhdHRycy5jcmlwRW50ZXIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7XHJcbiIsIihmdW5jdGlvbiAoY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuY29yZVxyXG4gICAgICAgIC5kaXJlY3RpdmUoJ2NyaXBGb2N1cycsIGNyaXBGb2N1cyk7XHJcblxyXG4gICAgY3JpcEZvY3VzLiRpbmplY3QgPSBbJ2ZvY3VzJ107XHJcblxyXG4gICAgZnVuY3Rpb24gY3JpcEZvY3VzKGZvY3VzKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgbGluazogbGlua1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjdHJsKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQub24oYXR0cnMuY3JpcEZvY3VzLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBmb2N1cyhhdHRycy5jcmlwU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZXMgYm91bmQgZXZlbnRzIGluIHRoZSBlbGVtZW50IGl0c2VsZlxyXG4gICAgICAgICAgICAvLyB3aGVuIHRoZSBzY29wZSBpcyBkZXN0cm95ZWRcclxuICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQub2ZmKGF0dHJzLmNyaXBGb2N1cyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkod2luZG93LmNyaXAgfHwgKHdpbmRvdy5jcmlwID0ge30pKTsiLCIoZnVuY3Rpb24gKG5nLCBjcmlwKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5jb3JlXHJcbiAgICAgICAgLmRpcmVjdGl2ZSgnY3JpcFRodW1iJywgY3JpcFRodW1iKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjcmlwVGh1bWIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8Y2FudmFzLz4nLFxyXG4gICAgICAgICAgICBsaW5rOiBsaW5rXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpe1xyXG4gICAgICAgICAgICBpZighbmcuZmlsZVN1cHBvcnQpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSBzY29wZS4kZXZhbChhdHRycy5jcmlwVGh1bWIpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFuZy5pc0ZpbGUocGFyYW1zLmZpbGUpIHx8ICFuZy5pc0ltYWdlKHBhcmFtcy5maWxlKSkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBjYW52YXMgPSBlbGVtZW50LmZpbmQoJ2NhbnZhcycpO1xyXG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuXHJcbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBvbkxvYWRGaWxlO1xyXG4gICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChwYXJhbXMuZmlsZSk7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkxvYWRGaWxlKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgICAgICAgICBpbWcub25sb2FkID0gb25Mb2FkSW1hZ2U7XHJcbiAgICAgICAgICAgICAgICBpbWcuc3JjID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gb25Mb2FkSW1hZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBwYXJhbXMud2lkdGggfHwgdGhpcy53aWR0aCAvIHRoaXMuaGVpZ2h0ICogcGFyYW1zLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBwYXJhbXMuaGVpZ2h0IHx8IHRoaXMuaGVpZ2h0IC8gdGhpcy53aWR0aCAqIHBhcmFtcy53aWR0aDtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5hdHRyKHt3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0fSk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXNbMF0uZ2V0Q29udGV4dCgnMmQnKS5kcmF3SW1hZ2UodGhpcywgMCwgMCwgd2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KShhbmd1bGFyLCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyIsIihmdW5jdGlvbiAoJCwgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuY29yZVxyXG4gICAgICAgIC5mYWN0b3J5KCdmb2N1cycsIGZvY3VzKTtcclxuXHJcbiAgICBmb2N1cy4kaW5qZWN0ID0gWyckdGltZW91dCddO1xyXG5cclxuICAgIGZ1bmN0aW9uIGZvY3VzKCR0aW1lb3V0KSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzZWxlY3RvciwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgLy8gdGltZW91dCBtYWtlcyBzdXJlIHRoYXQgaXQgaXMgaW52b2tlZCBhZnRlciBhbnkgb3RoZXIgZXZlbnQgaGFzIGJlZW4gdHJpZ2dlcmVkLlxyXG4gICAgICAgICAgICAvLyBlLmcuIGNsaWNrIGV2ZW50cyB0aGF0IG5lZWQgdG8gcnVuIGJlZm9yZSB0aGUgZm9jdXMgb3JcclxuICAgICAgICAgICAgLy8gaW5wdXRzIGVsZW1lbnRzIHRoYXQgYXJlIGluIGEgZGlzYWJsZWQgc3RhdGUgYnV0IGFyZSBlbmFibGVkIHdoZW4gdGhvc2UgZXZlbnRzXHJcbiAgICAgICAgICAgIC8vIGFyZSB0cmlnZ2VyZWQuXHJcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciAkZWxlbWVudCA9ICQoc2VsZWN0b3IpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCRlbGVtZW50Lmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRlbGVtZW50LmZvY3VzKGNhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRlbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoalF1ZXJ5LCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyIsIihmdW5jdGlvbiAoY3JpcCwgTWF0aCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuY29yZVxyXG4gICAgICAgIC5zZXJ2aWNlKCdjcmlwU3RyUmFuZG9tJywgY3JpcFN0clJhbmRvbSk7XHJcblxyXG4gICAgY3JpcFN0clJhbmRvbS4kaW5qZWN0ID0gW107XHJcblxyXG4gICAgZnVuY3Rpb24gY3JpcFN0clJhbmRvbSgpIHtcclxuICAgICAgICB2YXIgcG9zc2libGUgPSAnLV9BQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OV8tJztcclxuXHJcbiAgICAgICAgdGhpcy5jaGFuZ2VDaGFycyA9IGZ1bmN0aW9uIChjaGFycykge1xyXG4gICAgICAgICAgICBwb3NzaWJsZSA9IGNoYXJzO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMubmV3ID0gZnVuY3Rpb24gKGxlbmd0aCkge1xyXG4gICAgICAgICAgICBsZW5ndGggfD0gMTY7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSAnJztcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IHBvc3NpYmxlLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZS5sZW5ndGgpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59KSh3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSksIE1hdGgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
